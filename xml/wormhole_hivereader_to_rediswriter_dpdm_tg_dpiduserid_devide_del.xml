<?xml version="1.0" encoding="UTF-8"?>

<job id="hivereader_to_hbasewriter_job">
  <reader>
    <plugin>hivereader</plugin>
    <!--
default:jdbc:hive://10.1.1.161:10000/default
description:hive path ,format like "jdbc:hive://192.168.7.80:10000/default"
mandatory:true
name:path
-->
    <path>jdbc:hive://10.1.1.161:10000/bi</path>
    <!--
description:hive login name
mandatory:false
name:username
-->
    <username></username>
    <!--
description:hive login password
mandatory:false
name:password
-->
    <password></password>
    <!--
default:
range:
description:self-defined sql statement
mandatory:true
name:sql
-->
  
    <sql>select dpid_userid,active_days,is_buyed from bi.dpdm_tg_dpiduserid_devide_snapshot_cdc_del</sql>
	<!--
	<sql>select a.dpid_userid, '1' AS col from ( select distinct dpid_userid from bi.dpdm_tg_dpiduserid_devide ) a left outer join (select dpid_userid from bi.dpdm_tg_dpiduserid_devide  where hp_stat_time= '2015-01-18' ) b on a.dpid_userid = b.dpid_userid where b.dpid_userid is null</sql>
	-->
<!--
default:READ_FROM_HIVESERVER
range:READ_FROM_HIVESERVER,READ_FROM_HDFS
description:query mode, READ_FROM_HIVESERVER: fetch data directly from hive server, READ_FROM_HDFS: insert the data into hdfs directory and fetch data directly from datanode
mandatory:true
name:mode
-->
    <mode>READ_FROM_HDFS</mode>
    <!--
default:hdfs://10.2.6.102/tmp/
description:the temporary data directory to fetch on hdfs if using mode 2
mandatory:true
name:dataDir
-->
    <dataDir>hdfs://10.2.6.102/tmp/</dataDir>
    <!--
default:-1
range:1-1000
description:reduce task number when doing insert query, when it set to -1, hive will automatically computer reduce number
mandatory:true
name:reduceNumber
-->
    <reduceNumber>-1</reduceNumber>
    <!--
default:1
range:1-10
description:concurrency of the job
mandatory:false
name:concurrency
-->
    <concurrency>1</concurrency>
  </reader>
  <writer>
    <plugin>rediswriter</plugin>
    <table>bi.dpdm_tg_dpiduserid_devide</table>
    <family>dim</family>
    <keyIndex>0</keyIndex>
    <clear_key>true</clear_key>
    <columnsName>active_days,is_buyed</columnsName>
    <serialize>0</serialize>
    <separator>,</separator>
    <batchSize>300</batchSize>
    <concurrency>5</concurrency>
    <write_sleep>true</write_sleep>
    <wait_time>500</wait_time>
    <num_to_wait>20000</num_to_wait>
  </writer>
</job>
