<?xml version="1.0" encoding="UTF-8"?>

<job id="hivereader_to_hbasewriter_job">
  <reader>
    <plugin>hivereader</plugin>
    <path>jdbc:hive://10.1.1.161:10000/default</path>
    <username></username>
    <password></password>
    <sql>
    select shop_id,shop_id,shop_name,branch_name,city_id,city_name,daily_stats,traffic,score,socre_p1m,city_cat1_rank,city_cat1_rank_p1d,city_cat0_score_rank,city_cat0_score1_rank,city_cat0_score2_rank,city_cat0_score3_rank,city_cat0_pop_rank,city_cat1_score_rank,city_cat1_score1_rank,city_cat1_score2_rank,city_cat1_score3_rank,city_cat1_pop_rank,city_cat2_score_rank,city_cat2_score1_rank,city_cat2_score2_rank,city_cat2_score3_rank,city_cat2_pop_rank,district_cat0_score_rank,district_cat0_score1_rank,district_cat0_score2_rank,district_cat0_score3_rank,district_cat0_pop_rank,district_cat1_score_rank,district_cat1_score1_rank,district_cat1_score2_rank,district_cat1_score3_rank,district_cat1_pop_rank,district_cat2_score_rank,district_cat2_score1_rank,district_cat2_score2_rank,district_cat2_score3_rank,district_cat2_pop_rank,region_cat0_score_rank,region_cat0_score1_rank,region_cat0_score2_rank,region_cat0_score3_rank,region_cat0_pop_rank,region_cat1_score_rank,region_cat1_score1_rank,region_cat1_score2_rank,region_cat1_score3_rank,region_cat1_pop_rank,region_cat2_score_rank,region_cat2_score1_rank,region_cat2_score2_rank,region_cat2_score3_rank,region_cat2_pop_rank,city_cat0_shop_cnt,city_cat1_shop_cnt,city_cat2_shop_cnt,district_cat0_shop_cnt,district_cat1_shop_cnt,district_cat2_shop_cnt,region_cat0_shop_cnt,region_cat1_shop_cnt,region_cat2_shop_cnt,city_cat0_score_rank_p1d,city_cat0_score1_rank_p1d,city_cat0_score2_rank_p1d,city_cat0_score3_rank_p1d,city_cat0_pop_rank_p1d,city_cat1_score_rank_p1d,city_cat1_score1_rank_p1d,city_cat1_score2_rank_p1d,city_cat1_score3_rank_p1d,city_cat1_pop_rank_p1d,city_cat2_score_rank_p1d,city_cat2_score1_rank_p1d,city_cat2_score2_rank_p1d,city_cat2_score3_rank_p1d,city_cat2_pop_rank_p1d,district_cat0_score_rank_p1d,district_cat0_score1_rank_p1d,district_cat0_score2_rank_p1d,district_cat0_score3_rank_p1d,district_cat0_pop_rank_p1d,district_cat1_score_rank_p1d,district_cat1_score1_rank_p1d,district_cat1_score2_rank_p1d,district_cat1_score3_rank_p1d,district_cat1_pop_rank_p1d,district_cat2_score_rank_p1d,district_cat2_score1_rank_p1d,district_cat2_score2_rank_p1d,district_cat2_score3_rank_p1d,district_cat2_pop_rank_p1d,region_cat0_score_rank_p1d,region_cat0_score1_rank_p1d,region_cat0_score2_rank_p1d,region_cat0_score3_rank_p1d,region_cat0_pop_rank_p1d,region_cat1_score_rank_p1d,region_cat1_score1_rank_p1d,region_cat1_score2_rank_p1d,region_cat1_score3_rank_p1d,region_cat1_pop_rank_p1d,region_cat2_score_rank_p1d,region_cat2_score1_rank_p1d,region_cat2_score2_rank_p1d,region_cat2_score3_rank_p1d,region_cat2_pop_rank_p1d,city_cat0_shop_cnt_p1d,city_cat1_shop_cnt_p1d,city_cat2_shop_cnt_p1d,district_cat0_shop_cnt_p1d,district_cat1_shop_cnt_p1d,district_cat2_shop_cnt_p1d,region_cat0_shop_cnt_p1d,region_cat1_shop_cnt_p1d,region_cat2_shop_cnt_p1d
,review_cnt_week,review_cnt_week_p1w,star_week,score_week,score1_week,score2_week,score3_week,score_tend,score1_tend,score2_tend,score3_tend,score_1_cnt_week,score_2_cnt_week,score_3_cnt_week,score_4_cnt_week,score_5_cnt_week,score1_1_cnt_week,score1_2_cnt_week,score1_3_cnt_week,score1_4_cnt_week,score1_5_cnt_week,score2_1_cnt_week,score2_2_cnt_week,score2_3_cnt_week,score2_4_cnt_week,score2_5_cnt_week,score3_1_cnt_week,score3_2_cnt_week,score3_3_cnt_week,score3_4_cnt_week,score3_5_cnt_week,region_name,star,score1,score2,score3 from bi.dprpt_shop_daily_stats_cdc_delta
    </sql>
    <mode>READ_FROM_LOCAL</mode>
    <dataDir>hdfs://10.2.6.102/tmp/</dataDir>
    <reduceNumber>-1</reduceNumber>
    <concurrency>1</concurrency>
  </reader>
  <writer>
  <plugin>hbasewriter</plugin>
    <htable>bi.dprpt_shop_daily_stats</htable>
    <autoFlush>false</autoFlush>
    <writebufferSize>1048576</writebufferSize>
    <writeAheadLog>true</writeAheadLog>
    <rowKeyIndex>0</rowKeyIndex>
    <columnsName>dim:shop_id,dim:shop_name,dim:branch_name,dim:city_id,dim:city_name,dim:daily_stats,dim:traffic,dim:score,dim:socre_p1m,dim:city_cat1_rank,dim:city_cat1_rank_p1d,dim:city_cat0_score_rank,dim:city_cat0_score1_rank,dim:city_cat0_score2_rank,dim:city_cat0_score3_rank,dim:city_cat0_pop_rank,dim:city_cat1_score_rank,dim:city_cat1_score1_rank,dim:city_cat1_score2_rank,dim:city_cat1_score3_rank,dim:city_cat1_pop_rank,dim:city_cat2_score_rank,dim:city_cat2_score1_rank,dim:city_cat2_score2_rank,dim:city_cat2_score3_rank,dim:city_cat2_pop_rank,dim:district_cat0_score_rank,dim:district_cat0_score1_rank,dim:district_cat0_score2_rank,dim:district_cat0_score3_rank,dim:district_cat0_pop_rank,dim:district_cat1_score_rank,dim:district_cat1_score1_rank,dim:district_cat1_score2_rank,dim:district_cat1_score3_rank,dim:district_cat1_pop_rank,dim:district_cat2_score_rank,dim:district_cat2_score1_rank,dim:district_cat2_score2_rank,dim:district_cat2_score3_rank,dim:district_cat2_pop_rank,dim:region_cat0_score_rank,dim:region_cat0_score1_rank,dim:region_cat0_score2_rank,dim:region_cat0_score3_rank,dim:region_cat0_pop_rank,dim:region_cat1_score_rank,dim:region_cat1_score1_rank,dim:region_cat1_score2_rank,dim:region_cat1_score3_rank,dim:region_cat1_pop_rank,dim:region_cat2_score_rank,dim:region_cat2_score1_rank,dim:region_cat2_score2_rank,dim:region_cat2_score3_rank,dim:region_cat2_pop_rank,dim:city_cat0_shop_cnt,dim:city_cat1_shop_cnt,dim:city_cat2_shop_cnt,dim:district_cat0_shop_cnt,dim:district_cat1_shop_cnt,dim:district_cat2_shop_cnt,dim:region_cat0_shop_cnt,dim:region_cat1_shop_cnt,dim:region_cat2_shop_cnt,dim:city_cat0_score_rank_p1d,dim:city_cat0_score1_rank_p1d,dim:city_cat0_score2_rank_p1d,dim:city_cat0_score3_rank_p1d,dim:city_cat0_pop_rank_p1d,dim:city_cat1_score_rank_p1d,dim:city_cat1_score1_rank_p1d,dim:city_cat1_score2_rank_p1d,dim:city_cat1_score3_rank_p1d,dim:city_cat1_pop_rank_p1d,dim:city_cat2_score_rank_p1d,dim:city_cat2_score1_rank_p1d,dim:city_cat2_score2_rank_p1d,dim:city_cat2_score3_rank_p1d,dim:city_cat2_pop_rank_p1d,dim:district_cat0_score_rank_p1d,dim:district_cat0_score1_rank_p1d,dim:district_cat0_score2_rank_p1d,dim:district_cat0_score3_rank_p1d,dim:district_cat0_pop_rank_p1d,dim:district_cat1_score_rank_p1d,dim:district_cat1_score1_rank_p1d,dim:district_cat1_score2_rank_p1d,dim:district_cat1_score3_rank_p1d,dim:district_cat1_pop_rank_p1d,dim:district_cat2_score_rank_p1d,dim:district_cat2_score1_rank_p1d,dim:district_cat2_score2_rank_p1d,dim:district_cat2_score3_rank_p1d,dim:district_cat2_pop_rank_p1d,dim:region_cat0_score_rank_p1d,dim:region_cat0_score1_rank_p1d,dim:region_cat0_score2_rank_p1d,dim:region_cat0_score3_rank_p1d,dim:region_cat0_pop_rank_p1d,dim:region_cat1_score_rank_p1d,dim:region_cat1_score1_rank_p1d,dim:region_cat1_score2_rank_p1d,dim:region_cat1_score3_rank_p1d,dim:region_cat1_pop_rank_p1d,dim:region_cat2_score_rank_p1d,dim:region_cat2_score1_rank_p1d,dim:region_cat2_score2_rank_p1d,dim:region_cat2_score3_rank_p1d,dim:region_cat2_pop_rank_p1d,dim:city_cat0_shop_cnt_p1d,dim:city_cat1_shop_cnt_p1d,dim:city_cat2_shop_cnt_p1d,dim:district_cat0_shop_cnt_p1d,dim:district_cat1_shop_cnt_p1d,dim:district_cat2_shop_cnt_p1d,dim:region_cat0_shop_cnt_p1d,dim:region_cat1_shop_cnt_p1d,dim:region_cat2_shop_cnt_p1d
,dim:review_cnt_week,dim:review_cnt_week_p1w,dim:star_week,dim:score_week,dim:score1_week,dim:score2_week,dim:score3_week,dim:score_tend,dim:score1_tend,dim:score2_tend,dim:score3_tend,dim:score_1_cnt_week,dim:score_2_cnt_week,dim:score_3_cnt_week,dim:score_4_cnt_week,dim:score_5_cnt_week,dim:score1_1_cnt_week,dim:score1_2_cnt_week,dim:score1_3_cnt_week,dim:score1_4_cnt_week,dim:score1_5_cnt_week,dim:score2_1_cnt_week,dim:score2_2_cnt_week,dim:score2_3_cnt_week,dim:score2_4_cnt_week,dim:score2_5_cnt_week,dim:score3_1_cnt_week,dim:score3_2_cnt_week,dim:score3_3_cnt_week,dim:score3_4_cnt_week,dim:score3_5_cnt_week,dim:region_name,dim:star,dim:score1,dim:score2,dim:score3</columnsName>
    <deleteMode>0</deleteMode>
    <rollbackMode>0</rollbackMode>
    <concurrency>1</concurrency>
    <write_sleep>true</write_sleep>
    <wait_time>100</wait_time>
    <num_to_wait>20000</num_to_wait>
    <secondsDecTimeStamp>21600</secondsDecTimeStamp>
    <isDeleteData>false</isDeleteData>
    <isMajor_Compact>true</isMajor_Compact>
    <hiveConnectionUrl>jdbc:hive://10.1.1.161:10000/default</hiveConnectionUrl>
    <doPostDeleteDataFromHive>true</doPostDeleteDataFromHive>
    <selectRowkeysQuery>select shop_id from bi.dprpt_shop_daily_stats_cdc_del</selectRowkeysQuery> 
    <clusterConfigName>hbase-site-nanhui.xml</clusterConfigName> 
  </writer>
</job>
